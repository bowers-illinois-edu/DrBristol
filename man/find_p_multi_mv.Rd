% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/p_multiple_mv.R
\name{find_p_multi_mv}
\alias{find_p_multi_mv}
\title{Multi-rival testing: Multivariate Approach}
\usage{
find_p_multi_mv(
  obs_support,
  neutral_obs = 0,
  rival_obs = NULL,
  odds = 1,
  interpretation = FALSE,
  check_evidence = TRUE
)
}
\arguments{
\item{obs_support}{A vector of integers representing the number of
observations made in favor of the working hypothesis (anti-rival).
Each element corresponds to evidence against a specific rival.}

\item{neutral_obs}{Optional. An integer representing the number of observations
that are neither pro-working theory nor pro-rival.}

\item{rival_obs}{Optional. A vector of integers representing the number of
observations actually made that support each rival. Must be the same length
as obs_support. If NULL, assumes zero pro-rival observations.}

\item{odds}{The odds ratio for sampling (default 1 for central hypergeometric).
Can be a scalar or vector matching the urn composition length.}

\item{interpretation}{Logical. If TRUE, returns interpretation text with p-value.}

\item{check_evidence}{Logical. If TRUE, checks if obs_support are identical
across all rivals and suggests using find_p_multi_max_p() instead.}
}
\value{
Either a numeric p-value (scalar) or a list with p-value and interpretation.
}
\description{
This is a test of the composite null hypothesis that at least one rival
theory is more consistent with the data than the working theory:
Rival Theory 1 is true OR Rival Theory 2 is true OR ... Rival k is true.
}
\details{
We reject this composite hypothesis if we can reject all of the
individual hypotheses. There are two main approaches to this problem:
(1) Do the individual tests and use the maximum p-value (see Berger on
intersection-union tests and FWER control) or (2) represent this test
as a single test using a multivariate distribution. This function implements
the second option using the multivariate hypergeometric distribution.

The rejection region includes all outcomes with:
\itemize{
\item Anti-rival evidence >= observed levels for ALL rivals (componentwise)
\item Total pro-rival observations = observed total (or zero if none observed)
\item All possible allocations of pro-rival observations across rival types
}

On interpretation:
\itemize{
\item If p > alpha: "We cannot reject the union null hypothesis. The observed
evidence pattern is not sufficiently unlikely under the hypothesis that at
least one rival theory is correct. Therefore, we do not have strong enough
evidence to rule out all rival theories."
\item If p <= alpha: "We reject the union null hypothesis. The observed evidence
pattern would occur by chance only 100*p\% of the time if at least one rival
theory were actually correct. This provides strong statistical evidence that
all rival theories are wrong and the working theory is the correct explanation."
}

We assume a conservative urn model where the number of pro-rival observations
in the population is obs_support + 1 for each rival (following Lopez and Bowers 2026).
}
\examples{
# Example 1:
# One kind of working theory supporting information that argues against multiple rivals where
# each rival has the same amount of information.
# Notice that we will get the same answer as if we used `find_p_two_types()` directly.
# But we present this here to illustrate.
# 4 rivals, 10 observations of one kind of working theory supporting observation, 10 total observations made
find_p_multi_max_p(obs_support = rep(10, 4), total_obs = rep(10, 4))
find_p_multi_mv(obs_support = c(10, 10, 10, 10))
find_p_two_types(obs_support = 10, total_obs = 10)
# Example 2: No pro-rival observations made, different anti-rival evidence levels
find_p_multi_mv(obs_support = c(4, 3, 2, 1))

# Example 3: With pro-rival observations
find_p_multi_mv(obs_support = c(4, 3, 2, 1), rival_obs = c(1, 1, 0, 0))

# Example 4: With neutral observations
find_p_multi_mv(obs_support = c(4, 3, 2, 1), neutral_obs = 2)

}
