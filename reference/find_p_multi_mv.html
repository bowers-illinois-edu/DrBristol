<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Multi-rival testing: Multivariate Approach — find_p_multi_mv • DrBristol</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Multi-rival testing: Multivariate Approach — find_p_multi_mv"><meta name="description" content='This is a test of the composite null hypothesis that at least one rival
theory is more consistent with the data than the working theory:
Rival Theory 1 is true OR Rival Theory 2 is true OR ... Rival k is true.
This function tests only INFORMATIVE observations — those that distinguish
between working theory and rival theories. If you have neutral/uninformative
observations, exclude them before calling this function. The test is:
"Given n informative observations, how likely is this observed pattern if at least
one rival theory is correct?"'><meta property="og:description" content='This is a test of the composite null hypothesis that at least one rival
theory is more consistent with the data than the working theory:
Rival Theory 1 is true OR Rival Theory 2 is true OR ... Rival k is true.
This function tests only INFORMATIVE observations — those that distinguish
between working theory and rival theories. If you have neutral/uninformative
observations, exclude them before calling this function. The test is:
"Given n informative observations, how likely is this observed pattern if at least
one rival theory is correct?"'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DrBristol</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1.2000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Multi-rival testing: Multivariate Approach</h1>

      <div class="d-none name"><code>find_p_multi_mv.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This is a test of the composite null hypothesis that at least one rival
theory is more consistent with the data than the working theory:
Rival Theory 1 is true OR Rival Theory 2 is true OR ... Rival k is true.
This function tests only INFORMATIVE observations — those that distinguish
between working theory and rival theories. If you have neutral/uninformative
observations, exclude them before calling this function. The test is:
"Given n informative observations, how likely is this observed pattern if at least
one rival theory is correct?"</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">find_p_multi_mv</span><span class="op">(</span></span>
<span>  <span class="va">obs_support</span>,</span>
<span>  rival_obs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  odds <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  interpretation <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  check_evidence <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  messages <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-obs-support">obs_support<a class="anchor" aria-label="anchor" href="#arg-obs-support"></a></dt>
<dd><p>A vector of integers representing the number of
observations made in favor of the working hypothesis (anti-rival).
Each element corresponds to evidence against a specific rival.</p></dd>


<dt id="arg-rival-obs">rival_obs<a class="anchor" aria-label="anchor" href="#arg-rival-obs"></a></dt>
<dd><p>Optional. A vector of integers representing the number of
observations actually made that support each rival. Must be the same length
as obs_support. If NULL, assumes zero pro-rival observations.</p></dd>


<dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>Not used yet.</p></dd>


<dt id="arg-odds">odds<a class="anchor" aria-label="anchor" href="#arg-odds"></a></dt>
<dd><p>The odds ratio for sampling (default 1 for central
hypergeometric). Currently a scalar indicating odds of seeing any working
theory observations versus any rivals. To complicate in future versions.</p></dd>


<dt id="arg-interpretation">interpretation<a class="anchor" aria-label="anchor" href="#arg-interpretation"></a></dt>
<dd><p>Logical. If TRUE, returns interpretation text with p-value.</p></dd>


<dt id="arg-check-evidence">check_evidence<a class="anchor" aria-label="anchor" href="#arg-check-evidence"></a></dt>
<dd><p>Logical. If TRUE, checks if obs_support are identical
across all rivals and suggests using find_p_multi_max_p() instead. By pass
this message, set <code>check_evidence=FALSE</code> and <code>messages=FALSE</code></p></dd>


<dt id="arg-messages">messages<a class="anchor" aria-label="anchor" href="#arg-messages"></a></dt>
<dd><p>Logical. If TRUE, prints out a long message if <code>obs_support</code>
is identical across all rivals and <code>rival_obs=NULL</code>. If FALSE, doesn't print
that message.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Either a numeric p-value (scalar) or a list with p-value and interpretation.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>We reject this composite hypothesis if we can reject all of the
individual hypotheses. There are two main approaches to this problem:
(1) Do the individual tests and use the maximum p-value (see Berger on
intersection-union tests and FWER control) or (2) represent this test
as a single test using a multivariate distribution. This function implements
the second option using the multivariate hypergeometric distribution.</p>
<p>The rejection region includes all outcomes with:</p><ul><li><p>Anti-rival evidence &gt;= observed levels for ALL rivals (componentwise)</p></li>
<li><p>Total pro-rival observations = observed total (or zero if none observed)</p></li>
<li><p>All possible allocations of pro-rival observations across rival types</p></li>
</ul><p>On interpretation:</p><ul><li><p>If p &gt; alpha: "We cannot reject the union null hypothesis. The observed
evidence pattern is not sufficiently unlikely under the hypothesis that at
least one rival theory is correct. Therefore, we do not have strong enough
evidence to rule out all rival theories."</p></li>
<li><p>If p &lt;= alpha: "We reject the union null hypothesis. The observed evidence
pattern would occur by chance only 100*p% of the time if at least one rival
theory were actually correct. This provides strong statistical evidence that
all rival theories are wrong and the working theory is the correct explanation."</p></li>
</ul><p>We assume a conservative urn model where the number of pro-rival observations
in the population is obs_support + 1 for each rival (following Lopez and Bowers 2026).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example 1:</span></span></span>
<span class="r-in"><span><span class="co"># One kind of working theory supporting information that argues against multiple rivals where</span></span></span>
<span class="r-in"><span><span class="co"># each rival has the same amount of information.</span></span></span>
<span class="r-in"><span><span class="co"># Notice that we will get the same answer as if we used `find_p_two_types()` directly.</span></span></span>
<span class="r-in"><span><span class="co"># But we present this here to illustrate.</span></span></span>
<span class="r-in"><span><span class="co"># 4 rivals, 10 observations of one kind of working theory supporting</span></span></span>
<span class="r-in"><span><span class="co"># observation, 10 total observations made</span></span></span>
<span class="r-in"><span><span class="fu"><a href="find_p_multi_max_p.html">find_p_multi_max_p</a></span><span class="op">(</span>obs_support <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">4</span><span class="op">)</span>, total_obs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.835142e-06</span>
<span class="r-in"><span><span class="fu">find_p_multi_mv</span><span class="op">(</span>obs_support <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> It looks like you have only one kind of evidence that is inconsistent with multiple rivals. You would over-state your evidence against the rivals if we used a multivariate null-model by repeating the same number of anti-Rival observations. We are reporting here the p-value from the find_p_multi_max_p command. If you actually do have multiple types of observations but happen to have the same numbers of them, then you should try this command again but set check_evidence=FALSE and messages=FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.835142e-06</span>
<span class="r-in"><span><span class="fu"><a href="find_p_two_types.html">find_p_two_types</a></span><span class="op">(</span>obs_support <span class="op">=</span> <span class="fl">10</span>, total_obs <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.835142e-06</span>
<span class="r-in"><span><span class="fu"><a href="find_p_multi_max_p.html">find_p_multi_max_p</a></span><span class="op">(</span>obs_support <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">4</span><span class="op">)</span>, total_obs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">4</span><span class="op">)</span>, odds <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 7.707336e-05</span>
<span class="r-in"><span><span class="fu">find_p_multi_mv</span><span class="op">(</span>obs_support <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>, odds <span class="op">=</span> <span class="fl">2</span>, messages <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 7.707336e-05</span>
<span class="r-in"><span><span class="co"># Example 2: No pro-rival observations made, different anti-rival evidence levels</span></span></span>
<span class="r-in"><span><span class="fu">find_p_multi_mv</span><span class="op">(</span>obs_support <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5.098773e-07</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 3: With pro-rival observations</span></span></span>
<span class="r-in"><span><span class="fu">find_p_multi_mv</span><span class="op">(</span>obs_support <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, rival_obs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3.36519e-05</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 4: With pro-rival observations and non-uniform odds</span></span></span>
<span class="r-in"><span><span class="fu">find_p_multi_mv</span><span class="op">(</span>obs_support <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, rival_obs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, odds <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.0007486185</span>
<span class="r-in"><span><span class="fu">find_p_multi_mv</span><span class="op">(</span>obs_support <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, rival_obs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, odds <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 7.310727e-07</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matias Lopez, Jake Bowers.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

